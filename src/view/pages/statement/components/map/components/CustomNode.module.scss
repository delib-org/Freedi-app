// CustomNode.module.scss - Mind map node with add child/sibling buttons

.nodeContainer {
	position: relative;
	display: flex;
	justify-content: center;
	align-items: center;
}

.nodeContent {
	min-width: 5ch;
	max-width: 30ch;
	margin: 0.2rem;
	border-radius: 5px;
	padding: 0.5rem;
	display: flex;
	justify-content: center;
	align-items: center;
	font-size: 1rem;
	text-align: center;
	white-space: normal;
	word-break: break-word;
	transition: transform 0.2s ease, box-shadow 0.2s ease;
	cursor: pointer;
	border: 2px solid transparent;

	&:hover {
		transform: scale(1.02);
	}

	textarea {
		background: transparent;
		border: none;
		outline: none;
		resize: none;
		text-align: center;
		font-family: inherit;
		font-size: inherit;
		color: inherit;
		width: 100%;
	}
}

// Selected node gets a blue highlight border
.nodeContentSelected {
	border-color: #47b4ef;
	box-shadow: 0 0 0 2px rgba(71, 180, 239, 0.3);
}

// Actions container (overlay on top of node)
.nodeActions {
	position: absolute;
	inset: 0;
	pointer-events: none;

	> * {
		pointer-events: auto;
	}
}

// Blue "+" circle button for adding nodes
.addButton {
	position: absolute;
	width: 24px;
	height: 24px;
	border-radius: 50%;
	display: flex;
	align-items: center;
	justify-content: center;
	background: #47b4ef;
	border: none;
	color: white;
	font-size: 18px;
	font-weight: 700;
	line-height: 1;
	cursor: pointer;
	z-index: 10;
	padding: 0;
	transition: background 0.15s ease, transform 0.15s ease;
	animation: fabEnter 0.15s ease-out;

	&:hover {
		background: #3a9fd6;
		transform: scale(1.2);
	}

	&:active {
		transform: scale(0.9);
	}

	&:focus-visible {
		outline: 2px solid var(--accent, #47b4ef);
		outline-offset: 2px;
	}
}

// Child button positions per layout direction
.addButtonChildLR {
	right: -14px;
	top: calc(50% - 12px);
}

.addButtonChildTB {
	bottom: -14px;
	left: calc(50% - 12px);
}

// Sibling button positions per layout direction
.addButtonSiblingLR {
	bottom: -14px;
	left: calc(50% - 12px);
}

.addButtonSiblingTB {
	left: -14px;
	top: calc(50% - 12px);
}

// Ellipsis menu button
.menuButton {
	position: absolute;
	right: -10px;
	top: -10px;
	width: 24px;
	height: 24px;
	border-radius: 50%;
	display: flex;
	align-items: center;
	justify-content: center;
	background: var(--white, #fff);
	border: 1px solid #ddd;
	box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
	cursor: pointer;
	transition: all 0.15s ease;
	z-index: 11;
	padding: 0;
	color: var(--text-body, #555);
	animation: fabEnter 0.15s ease-out;

	&:hover {
		background: #f5f5f5;
		transform: scale(1.1);
	}

	&:focus-visible {
		outline: 2px solid var(--accent, #47b4ef);
		outline-offset: 1px;
	}

	svg {
		width: 14px;
		height: 14px;
	}
}

// Context menu container
.menuContainer {
	position: absolute;
	z-index: 999;
}

.menuContainerTB {
	right: 0;
	bottom: calc(100% + 10px);
}

.menuContainerLR {
	left: 0;
	top: calc(100% + 10px);
}

// Keyboard shortcut hints
.keyboardHints {
	position: absolute;
	display: flex;
	flex-direction: column;
	gap: 6px;
	white-space: nowrap;
	font-size: 12px;
	color: var(--text-body, #555);
	animation: fadeIn 0.2s ease-out;
	z-index: 5;
	pointer-events: none;
}

.keyboardHintsLR {
	left: calc(100% + 24px);
	top: 50%;
	transform: translateY(-50%);
}

.keyboardHintsTB {
	top: calc(100% + 24px);
	left: 50%;
	transform: translateX(-50%);
	align-items: center;
}

.keyboardHint {
	display: flex;
	align-items: center;
	gap: 6px;
}

.keyboardKey {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	min-width: 28px;
	height: 22px;
	padding: 0 6px;
	background: #f0f0f0;
	border: 1px solid #ccc;
	border-bottom: 2px solid #bbb;
	border-radius: 4px;
	font-size: 11px;
	font-weight: 600;
	font-family: inherit;
	color: #444;
}

.keyboardHintText {
	color: #666;
	font-size: 12px;
}

// Animations
@keyframes fabEnter {
	from {
		opacity: 0;
		transform: scale(0.5);
	}
	to {
		opacity: 1;
		transform: scale(1);
	}
}

@keyframes fadeIn {
	from {
		opacity: 0;
	}
	to {
		opacity: 1;
	}
}

// Tremble animation for nodes
.trembleAnimate {
	animation: tremble 0.3s ease-in-out infinite;
}

@keyframes tremble {
	0% {
		transform: translateX(0);
	}
	25% {
		transform: translateX(-2px) translateY(2px);
	}
	50% {
		transform: translateX(2px);
	}
	75% {
		transform: translateX(-2px) translateY(2px);
	}
	100% {
		transform: translateX(0);
	}
}

// Mobile adjustments
@media (max-width: 767px) {
	.addButton {
		width: 28px;
		height: 28px;
		font-size: 20px;
	}

	// Hide keyboard hints on mobile (no keyboard)
	.keyboardHints {
		display: none;
	}
}

// Touch device optimizations
@media (hover: none) {
	.addButton {
		width: 32px;
		height: 32px;
		font-size: 20px;

		// Larger touch target
		&::after {
			content: '';
			position: absolute;
			inset: -6px;
		}
	}

	.keyboardHints {
		display: none;
	}
}
